#!/usr/bin/env bash

set -x

# exiting if not sudo
if [ "$(id -u)" != "0" ]; then # this script requires root privileges
   exit 1
fi

# link to Github vimrc
my_orig='/home/perubu/Documents/GitHub/3.c.systems-install-n-maintain/vim/vimrc'
my_link=/home/perubu/.vim/"$(basename $my_orig)"
# force to recreate possibly existing link and check that it is not broken
if ! ln -fs "$my_orig" "$my_link" || [ ! -e "${my_link}" ]; then
   exit 1
fi

# link to Github .zshrc
my_orig='/home/perubu/Documents/GitHub/3.a.1-linux/3. zsh/.zshrc'
my_link=/home/perubu/"$(basename "$my_orig")"
if ! ln -fs "$my_orig" "$my_link" || [ ! -e "${my_link}" ]; then
   exit 1
fi

# link to all Github bash scripts whose filename starts with ,
if ! find /home/perubu/Documents/GitHub/3.c.systems-install-n-maintain/Linux\ Mint\ 20/ \
   -type f -name ',*.sh' \
   -exec sudo ln -fs {} /usr/local/sbin/ \;; then
   exit 1
fi
# where the literal {} gets substituted by the filename and the literal \; is needed for find to know that the custom command ends there.

# link to VSCode snippets
if ! find /home/perubu/Documents/GitHub/3.a.2-vsCode/config/Code/User/snippets/ \
   -type f \
   -name '*.json' \
   -exec sudo ln \
   -fs {} /home/perubu/.config/Code/User/snippets/ \;; then
   exit 1
fi

# link to VSCode tasks.json
if ! ln -fs '/home/perubu/Documents/GitHub/3.a.2-vsCode/config/Code/User/tasks.json' \
   '/home/perubu/.config/Code/User/'; then
   exit 1
fi

# put shellSpec in path
if ! ln -fs '/home/perubu/.local/lib/shellspec/shellspec' \
   '/usr/local/sbin/'; then
   exit 1
fi

echo 'No error detected, exiting'
set +x
